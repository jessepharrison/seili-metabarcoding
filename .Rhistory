marr.seq <- seqdef(married)
left.seq <- seqdef(left)
## Using transition rates to compute substitution costs on each channel
mcdist <- seqdistmc(channels=list(child.seq, marr.seq, left.seq),
method="OM", sm =list("TRATE", "TRATE", "TRATE"))
## Using a weight of 2 for children channel and specifying substitution-cost
smatrix <- list()
smatrix[[1]] <- seqsubm(child.seq, method="CONSTANT")
smatrix[[2]] <- seqsubm(marr.seq, method="CONSTANT")
smatrix[[3]] <- seqsubm(left.seq, method="TRATE")
mcdist2 <- seqdistmc(channels=list(child.seq, marr.seq, left.seq),
method="OM", sm =smatrix, cweight=c(2,1,1))
# Computes agglomerative hierarchical clustering of the dataset.
tic()
ward_mc <- agnes(mcdist2, diss=TRUE, method="ward")
toc()
install.packages("flashClust")
tic()
flashClust::flashClust(mcdist, method = ward)
toc()
tic()
flashClust::flashClust(mcdist2, method = ward)
toc()
tic()
flashClust::flashClust(mcdist2, method = "ward")
toc()
tic()
flashClust::flashClust(mcdist2, method = "ward.D2")
toc()
cl <- kmeans(mcdist2, 1000, iter.max = 20)
str(mcdist2)
install.packages("fastcluster")
fastcluster::hclust.vector(mcdist2, method = "ward")
tic()
ward_mc <- agnes(mcdist2, diss=TRUE, method="ward")
toc()
tic()
fastcluster::hclust.vector(mcdist2, method = "ward")
toc()
mcdist2
data(votes.repub)
agn1 <- agnes(votes.repub, metric = "manhattan", stand = TRUE)
agn1
plot(agn1)
install.packages("genieclust")
genieclust::gclust(mcdist2)
tic()
genieclust::gclust(mcdist2)
toc()
tic()
test <- genieclust::gclust(mcdist2)
toc()
test
plot(test)
plot(ward_mc)
plot(test)
sessionInfo()
remotes::install_github("albertopessia/drda@devel", force = TRUE)
install.packages("devtools")
install.packages("usethis")
install.packages("devtools")
install.packages("roxygen2")
install.packages("devtools")
remotes::install_github("albertopessia/drda@devel", force = TRUE)
library(drda)
data <- data.frame(
y = c(
1.33247, 0.92844, 0.83133, 0.85937, 0.65816, 1.57471, 0.91199, 0.94208,
1.23818, 1.13466, 0.9641, 0.99347, 1.06009, 1.00814, 1.02401, 1.16768,
0.64734, 1.27722, 1.0498, 0.94723, 1.09521, 1.16793, 1.05917, 0.86514,
1.03405, 0.97345, 1.08475, 1.42686, 0.86831, 1.18445, 0.96432, 1.17698,
1.33832, 1.06965, 0.91873, 1.61137, 1.20967, 1.12732, 1.26277, 0.98449,
0.8448, 1.77046, 0.90366, 1.33943, 1.12403, 0.77396, 1.7221, 0.87106,
1.21629, 0.98583, 1.165, 0.99248, 1.1924, 1.18224, 1.09688, 1.1166,
1.15364, -0.10949, 2.85117, 0.62544, 1.08089, 1.05483, 1.2314, 1.01362,
1.21547, 1.13804, 1.08187, 1.17875, 1.10649, 0.93402, 1.23005, 1.58808,
1.30672, 1.22205, 1.22338, 1.16721, 1.56238, 0.82263, 1.33748, 1.20973,
1.00501, 0.9047, 1.63791, 1.00961, 0.95051, 1.29103, 1.15532, 1.03695,
1.23172, 1.12819, 0.93078, 1.29048, 1.1756, 1.0103, 0.98997, 1.39659,
1.05155, 1.22088, 1.12443, 2.91453, 0.21079, 0.27154, 0.99944, 1.2088,
1.18862, 1.29992, 1.48525, 0.6117, 1.13695, 1.10504, 1.15487, 1.24335,
1.06294, 0.92386, 1.01849, 1.11516, 1.09649, 1.10585, 1.05961, 1.2367,
1.1279, 1.13867, 1.13559, 0.7032, 0.89504, 1.80392, 1.12543, 0.95734,
1.55187, 1.2948, 0.46013, 1.87971, 1.11376, 1.13564, 1.38524, 1.33316,
1.13323, 1.16825, 1.2453, 1.19623, 1.19311, 1.96109, -0.30945, 1.983,
1.0986, 1.23817, 1.29787, 1.27216, 1.43834, 0.92413, 1.21184, 1.27186,
1.15094, 0.76331, 1.4615, 1.00461, 0.93425, 1.01425, 1.28092, 1.10384,
0.97996, 1.5941, 1.19492, 1.28035, 1.20262, 0.84447, 0.83008, 2.00334,
1.06925, 1.02318, 1.00264, 1.02233, 0.81703, 1.25571, 1.013, 0.84136,
1.24072, 1.09306, 1.05127, 0.95074, 1.04941, 1.0268, 1.01886, 0.94986,
0.70887, 1.43634, 1.07934, 0.94565, 1.07009, 0.88262, 1.59085, 0.6216,
1.01688, 0.98162, 1.09657, 1.23771, 0.86516, 1.25335, 0.9603, 0.9203,
1.47563, 0.99005, 1.39569, 1.11916, 1.17728, 1.18036, 1.14726, 0.94288,
1.0454, 1.51662, 1.03082, 1.39625, 1.10365, 1.28102, 0.99441, 1.25528,
1.0194, 1.26011, 1.25122, 1.26124, 1.19121, 1.07826, 1.18011, 1.16496,
1.18564, 2.06786, 0.79964, 0.66321, 1.15028, 1.09479, 1.28565, 1.44924,
1.22911, 0.85237, 1.16418, 1.16171, 1.20483, 1.82831, 1.1614, 1.29545,
1.35216, 1.44483, 1.48816, 1.46052, 1.35496, 1.28518, 1.26119, 1.8107,
1.02876, 1.81653, 0.99279, 1.29135, 1.49577, 1.30279, 1.50387, 1.58427,
1.27193, 1.44623, 1.2103, 1.50298, 1.58914, 1.35545, 1.32044, 1.62654,
1.47182, 1.45114, 1.37946, 0.83812, 0.97605, 2.48825, 1.2402, 1.53952,
1.52271, 1.35613, 1.73113, 1.21517, 1.44002, 1.39209, 1.47032, 1.33531,
1.17556, 2.47421, 1.63281, 1.77547, 1.57681, 0.72456, 1.63442, 1.11101,
1.21336, 0.6423, 1.61433, 1.1125, 1.09931, 1.25818, -0.14996, -0.11074,
1.5477, 0.44733, 0.42276, 0.41691, 0.41988, 0.41373, 0.45339, 0.16432,
0.77539, 0.3473, 0.427, 0.43205, 0.42796, 0.43199, 0.43448, 0.42054,
0.06689, 1.07754, 0.14257, 0.93944, 0.32343, 0.02413, 0.38238, 0.46892,
0.4357, 0.46633, 0.35239, 0.37194, -0.07156, 1.31711, -0.05489, 0.47842,
0.46882, 2.20566, 1.41192, 0.21284, 1.52813, 1.67027, -0.28956, 1.77219,
1.02801, -0.82341, 1.14505, 0.461, 0.44345, 0.4452, 0.47268, 0.43438,
0.44259, 0.43633, 0.45214, 0.46118, 0.18218, 0.18796, 0.97951, 0.44175,
0.45071, 0.45719, 0.82741, -0.33459, 0.85683, 0.45771, 0.44988, 0.44205,
0.72925, -0.14891, 0.76931, 0.30016, 0.30351, 0.29625, 0.52464, -0.0207,
0.39597, 0.40494, 0.39971, 1.46746, 0.57086, 0.62089, 1.08036, 0.07312,
0.04734, 2.15165
),
x = c(
-8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971,
-8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971,
-8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971,
-8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.67971, -8.07894,
-8.07894, -8.07894, -8.07894, -8.07894, -8.07894, -7.98656, -7.98656,
-7.98656, -7.98656, -7.98656, -7.98656, -7.98656, -7.98656, -7.98656,
-7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027,
-7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027,
-7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027,
-7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -7.07027, -6.47597,
-6.47597, -6.47597, -6.47597, -6.47597, -6.47597, -6.37126, -6.37126,
-6.37126, -6.37126, -6.37126, -6.37126, -6.37126, -6.37126, -6.37126,
-5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614,
-5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614,
-5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614,
-5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -5.45614, -4.86914,
-4.86914, -4.86914, -4.86914, -4.86914, -4.86914, -4.76417, -4.76417,
-4.76417, -4.76417, -4.76417, -4.76417, -4.76417, -4.76417, -4.76417,
-3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905,
-3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905,
-3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905,
-3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.84905, -3.25970,
-3.25970, -3.25970, -3.25970, -3.25970, -3.25970, -3.15356, -3.15356,
-3.15356, -3.15356, -3.15356, -3.15356, -3.15356, -3.15356, -3.15356,
-2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493,
-2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493,
-2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493,
-2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -2.23493, -1.65026,
-1.65026, -1.65026, -1.65026, -1.65026, -1.65026, -1.54646, -1.54646,
-1.54646, -1.54646, -1.54646, -1.54646, -1.54646, -1.54646, -1.54646,
-0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923,
-0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923,
-0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923,
-0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.62923, -0.04082,
-0.04082, -0.04082, -0.04082, -0.04082, -0.04082, 0.06766, 0.06766,
0.06766, 0.06766, 0.06766, 0.06766, 0.06766, 0.06766, 0.06766, 0.98208,
0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208,
0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208,
0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208, 0.98208,
0.98208, 0.98208, 1.56862, 1.56862, 1.56862, 1.56862, 1.56862, 1.56862,
1.67335, 1.67335, 1.67335, 1.67335, 1.67335, 1.67335, 1.67335, 1.67335,
1.67335, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776,
2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776,
2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776, 2.58776,
2.58776, 2.58776, 2.58776, 2.58776, 3.17805, 3.17805, 3.17805, 3.17805,
3.17805, 3.17805, 3.28466, 3.28466, 3.28466, 3.28466, 3.28466, 3.28466,
3.28466, 3.28466, 3.28466, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002,
4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002,
4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002, 4.2002,
4.2002, 4.2002, 4.2002, 4.78749, 4.78749, 4.78749, 4.78749, 4.78749,
4.78749, 4.89035, 4.89035, 4.89035, 4.89035, 4.89035, 4.89035, 4.89035,
4.89035, 4.89035
)
)
(fit <- drda(y ~ x, data = data))
sessionInfo()
plot(sunspots)
par(mar = c(4, 4, .1, .2)); plot(sunspots)
capabilities()[["X11"]]
library(tidyverse)
data <- read_csv("/home/jharriso/Desktop/test.csv")
data
library(tidyverse)
data <- read_csv("/home/jharriso/Desktop/test.csv")
ggplot(mydataset, aes(x = Exact,
y = Approx, color = ApproxType)) +
geom_point()
library(tidyverse)
mydataset <- read_csv("/home/jharriso/Desktop/test.csv")
ggplot(mydataset, aes(x = Exact,
y = Approx, color = ApproxType)) +
geom_point()
rm(list=ls())
# additional libpath ####
# (see extra_RPackages.R for extra package installs)
.libPaths(c("/home/jharriso/seili-singularity/rpackages", .libPaths()))
# set libpath
.libPaths(c("/home/jharriso/seili-singularity/rpackages", .libPaths()))
libpath <- .libPaths()[1]
installl.packages("targets", lib = libpath)
install.packages("targets", lib = libpath)
remotes::install_github("ropensci/targets", lib = libpath)
# Seili 16S analysis - jesse harrison 2020-2021
# using seili-r Singularity container (based on seili-r.def)
# additional libpath ####
# (see extra_RPackages.R for extra package installs)
.libPaths(c("~/seili-singularity/rpackages", .libPaths()))
# packages ####
packages <- c("magick")
lapply(packages, require, character.only = TRUE)
# sessioninfo ####
# > sessionInfo()
# R version 4.0.2 (2020-06-22)
# Platform: x86_64-pc-linux-gnu (64-bit)
# Running under: Ubuntu 18.04.5 LTS
# Matrix products: default
# BLAS/LAPACK: /opt/intel/compilers_and_libraries_2020.0.166/linux/mkl/lib/intel64_lin/libmkl_gf_lp64.so
# locale:
# [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8
# [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base
# other attached packages:
# [1] magick_2.5.2
# loaded via a namespace (and not attached):
#  [1] Biobase_2.50.0      pkgload_1.1.0       tidyr_1.1.2         jsonlite_1.7.1      splines_4.0.2       foreach_1.5.1       assertthat_0.2.1
#  [8] BiocManager_1.30.10 stats4_4.0.2        phyloseq_1.34.0     remotes_2.2.0       progress_1.2.2      sessioninfo_1.1.1   pillar_1.4.7
# [15] lattice_0.20-41     glue_1.4.2          digest_0.6.27       XVector_0.30.0      colorspace_2.0-0    Matrix_1.2-18       plyr_1.8.6
# [22] pkgconfig_2.0.3     devtools_2.3.2      microbiome_1.12.0   zlibbioc_1.36.0     purrr_0.3.4         scales_1.1.1        processx_3.4.4
# [29] Rtsne_0.15          tibble_3.0.4        mgcv_1.8-33         generics_0.1.0      IRanges_2.24.0      ggplot2_3.3.2       usethis_1.6.3
# [36] ellipsis_0.3.1      withr_2.3.0         BiocGenerics_0.36.0 cli_2.2.0           survival_3.2-7      magrittr_2.0.1      crayon_1.3.4
# [43] memoise_1.1.0       ps_1.4.0            fs_1.5.0            fansi_0.4.1         nlme_3.1-150        MASS_7.3-53         pkgbuild_1.1.0
# [50] vegan_2.5-7         tools_4.0.2         data.table_1.13.2   prettyunits_1.1.1   hms_0.5.3           lifecycle_0.2.0     stringr_1.4.0
# [57] Rhdf5lib_1.12.0     S4Vectors_0.28.0    munsell_0.5.0       cluster_2.1.0       callr_3.5.1         Biostrings_2.58.0   ade4_1.7-16
# [64] compiler_4.0.2      tinytex_0.27        rlang_0.4.9         rhdf5_2.34.0        grid_4.0.2          iterators_1.0.13    rhdf5filters_1.2.0
# [71] biomformat_1.18.0   rstudioapi_0.13     igraph_1.2.6        testthat_3.0.0      gtable_0.3.0        codetools_0.2-18    multtest_2.46.0
# [78] reshape2_1.4.4      R6_2.5.0            dplyr_1.0.2         rprojroot_2.0.2     permute_0.9-5       desc_1.2.0          ape_5.4-1
# [85] stringi_1.5.3       parallel_4.0.2      Rcpp_1.0.5          vctrs_0.3.5         tidyselect_1.1.0    xfun_0.19
# ggplot2 theme ####
theme_set(theme_classic())
# working directory ####
setwd("~/git/seili-metabarcoding/")
# note: running gc() several times to clear cache ####
# fig 3 ####
# read in the files
fig3a <- image_read('figures/r_output/Fig3a_16S.tiff')
fig3b <- image_read('figures/r_output/Fig3b_18S.tiff')
# combine the elements
fig3 <- c(fig3a, fig3b)
fig3 <- image_append(fig3)
# add some white space
fig3 <- image_border(fig3, color = "white", geometry = "00x120")
# add letters
fig3 <- image_annotate(fig3, text = "a)",
size = 140, color = "black",
location = "0+0")
fig3 <- image_annotate(fig3, text = "b)",
size = 140, color = "black",
location = "+1772+0")
# crop the bottom white space
fig3 <- image_crop(fig3, "3544x1900")
# export the figure
image_write(fig3, path = "figures/r_output/combined_figs/fig3.tiff",
format = "tiff", quality = 100)
# remove files
rm(fig3, fig3a, fig3b)
# clear up the env
gc()
# fig 4 ####
# read in the files
fig4a <- image_read('figures/r_output/Fig4a_16S.tiff')
fig4b <- image_read('figures/r_output/Fig4b_18S.tiff')
# combine the elements
fig4 <- c(fig4a, fig4b)
fig4 <- image_append(fig4, stack = TRUE)
# add some white space
fig4 <- image_border(fig4, color = "white", geometry = "00x120")
# add letters
fig4 <- image_annotate(fig4, text = "a)",
size = 140, color = "black",
location = "0+0")
fig4 <- image_annotate(fig4, text = "b)",
size = 140, color = "black",
location = "+0+2362")
# clear up the env
gc()
# crop the bottom white space
fig4 <- image_crop(fig4, "3189x4840")
# export the figure
image_write(fig4, path = "figures/r_output/combined_figs/fig4.tiff",
format = "tiff", quality = 100)
# remove files
rm(fig4, fig4a, fig4b)
# clear up the env
gc()
# fig 5 ####
# read in the files
fig5a <- image_read('figures/r_output/Fig5a_16S.tiff')
fig5b <- image_read('figures/r_output/Fig5b_18S.tiff')
# add some white space to fig5a for composite centering
fig5a <- image_border(fig5a, color = "white", geometry = "472x00")
# combine the elements
fig5 <- c(fig5a, fig5b)
fig5 <- image_append(fig5, stack = TRUE)
# add some white space to the composite
fig5 <- image_border(fig5, color = "white", geometry = "00x120")
# add letters
fig5 <- image_annotate(fig5, text = "a)",
size = 140, color = "black",
location = "0+0")
fig5 <- image_annotate(fig5, text = "b)",
size = 140, color = "black",
location = "+0+2362")
# clear up the env
gc()
# crop the bottom white space
fig5 <- image_crop(fig5, "3189x4750")
# export the figure
image_write(fig5, path = "figures/r_output/combined_figs/fig5.tiff",
format = "tiff", quality = 100)
# remove files
rm(fig5, fig5a, fig5b)
# clear up the env
gc()
# fig 6 ####
#read in the file
fig6 <- image_read('figures/r_output/Fig6_18S.tiff')
# trim the image
fig6 <- image_trim(fig6)
# export the figure
image_write(fig6, path = "figures/r_output/Fig6_18s.tiff",
format = "tiff", quality = 100)
# clear up the env
gc()
# fig 7 ####
# read in the files
fig7a <- image_read('figures/r_output/Fig7a_16S.tiff')
fig7b <- image_read('figures/r_output/Fig7b_18S.tiff')
fig7c <- image_read('figures/r_output/Fig7c_16S.tiff')
fig7d <- image_read('figures/r_output/Fig7d_18S.tiff')
# clear up the env
gc()
# combine top elements
fig7.up <- c(fig7a, fig7b)
fig7.up <- image_append(fig7.up)
# add some white space to top element
fig7.up <- image_border(fig7.up, color = "white", geometry = "00x120")
# add letters to top element
fig7.up <- image_annotate(fig7.up, text = "a)",
size = 140, color = "black",
location = "0+0")
fig7.up <- image_annotate(fig7.up, text = "b)",
size = 140, color = "black",
location = "+2362+0")
# crop the bottom white space of the top element
fig7.up <- image_crop(fig7.up, "4724x2480")
# combine the bottom elements
fig7.down <- c(fig7c, fig7d)
fig7.down <- image_append(fig7.down)
# add some white space to bottom element
fig7.down <- image_border(fig7.down, color = "white", geometry = "00x120")
# clear up the env
gc()
# add letters to top element
fig7.down <- image_annotate(fig7.down, text = "c)",
size = 140, color = "black",
location = "0+0")
fig7.down <- image_annotate(fig7.down, text = "d)",
size = 140, color = "black",
location = "+2362+0")
# crop the bottom white space of the bottom element
fig7.down <- image_crop(fig7.down, "4724x2480")
# stack the top + bottom elements
fig7 <- c(fig7.up, fig7.down)
fig7 <- image_append(fig7, stack = TRUE)
# export the figure
image_write(fig7, path = "figures/r_output/combined_figs/fig7.tiff",
format = "tiff", quality = 100)
# remove files
rm(fig7, fig7.down, fig7.up, fig7a, fig7b, fig7c, fig7d)
# clear up the env
gc()
# fig S1 ####
# read in the files
figS1a <- image_read('figures/r_output/FigS1a_16S.tiff')
figS1b <- image_read('figures/r_output/FigS1b_18S.tiff')
# combine the elements
figS1 <- c(figS1a, figS1b)
figS1 <- image_append(figS1)
# adjust the white space
figS1 <- image_crop(figS1, "5906x2900")
figS1 <- image_trim(figS1)
figS1 <- image_border(figS1, color = "white", geometry = "00x120")
# add letters
figS1 <- image_annotate(figS1, text = "a)",
size = 140, color = "black",
location = "0+0")
figS1 <- image_annotate(figS1, text = "b)",
size = 140, color = "black",
location = "+2953+0")
# crop the bottom white space
figS1 <- image_crop(figS1, "5757x2750")
# export the figure
image_write(figS1, path = "figures/r_output/combined_figs/figS1.tiff",
format = "tiff", quality = 100)
# remove files
rm(figS1, figS1a, figS1b)
# clear up the env
gc()
# fig S2 ####
# read in the files
figS2a <- image_read('figures/r_output/FigS2a_16S.tiff')
figS2b <- image_read('figures/r_output/FigS2b_18S.tiff')
# combine the elements
figS2 <- c(figS2a, figS2b)
figS2 <- image_append(figS2, stack = TRUE)
# add some white space
figS2 <- image_border(figS2, color = "white", geometry = "00x120")
# add letters
figS2 <- image_annotate(figS2, text = "a)",
size = 140, color = "black",
location = "0+0")
figS2 <- image_annotate(figS2, text = "b)",
size = 140, color = "black",
location = "+0+2362")
# crop the bottom white space
figS2 <- image_crop(figS2, "3189x4850")
# export the figure
image_write(figS2, path = "figures/r_output/combined_figs/figS2.tiff",
format = "tiff", quality = 100)
# remove files
rm(figS2, figS2a, figS2b)
# clear up the env
gc()
# fig S3 ####
# read in the files
figS3a <- image_read('figures/r_output/FigS3a_16S.tiff')
figS3b <- image_read('figures/r_output/FigS3b_16S.tiff')
figS3c <- image_read('figures/r_output/FigS3c_16S.tiff')
figS3d <- image_read('figures/r_output/FigS3d_18S.tiff')
figS3e <- image_read('figures/r_output/FigS3e_18S.tiff')
# combine the elements (upper section)
figS3.up <- c(figS3a, figS3b, figS3c)
figS3.up <- image_append(figS3.up)
# add some white space
figS3.up <- image_border(figS3.up, color = "white", geometry = "00x120")
# add letters
figS3.up <- image_annotate(figS3.up, text = "a)",
size = 140, color = "black",
location = "0+0")
figS3.up <- image_annotate(figS3.up, text = "b)",
size = 140, color = "black",
location = "+1772+0")
figS3.up <- image_annotate(figS3.up, text = "c)",
size = 140, color = "black",
location = "+3544+0")
# crop the bottom white space
figS3.up <- image_crop(figS3.up, "5316x1900")
# combine the elements (lower section)
figS3.down <- c(figS3d, figS3e)
figS3.down <- image_append(figS3.down)
# add some white space
figS3.down <- image_border(figS3.down, color = "white", geometry = "00x120")
# add letters
figS3.down <- image_annotate(figS3.down, text = "d)",
size = 140, color = "black",
location = "0+0")
figS3.down <- image_annotate(figS3.down, text = "e)",
size = 140, color = "black",
location = "+1772+0")
# crop the bottom white space
figS3.down <- image_crop(figS3.down, "3544x1900")
# clear up the env
gc()
# combine the upper and lower sections
figS3 <- c(figS3.up, figS3.down)
figS3 <- image_append(figS3, stack = TRUE)
# export the figure
image_write(figS3, path = "figures/r_output/combined_figs/figS3.tiff",
format = "tiff", quality = 100)
# remove objects
rm(figS3, figS3.down, figS3.up, figS3a, figS3b, figS3c, figS3d, figS3e)
# fig S4 ####
# read in the files
figS4a <- image_read('figures/r_output/FigS4a_16S.tiff')
figS4b <- image_read('figures/r_output/FigS4b_18S.tiff')
# combine the elements
figS4 <- c(figS4a, figS4b)
figS4 <- image_append(figS4, stack = TRUE)
# clear up the env
gc()
# add some white space
figS4 <- image_border(figS4, color = "white", geometry = "00x120")
# clear up the env
gc()
# add letters
figS4 <- image_annotate(figS4, text = "a)",
size = 140, color = "black",
location = "0+0")
# clear up the env
gc()
figS4 <- image_annotate(figS4, text = "b)",
size = 140, color = "black",
location = "+0+4138")
# clear up the env
gc()
# crop the bottom white space
figS4 <- image_crop(figS4, "5315x8000")
# export the figure
image_write(figS4, path = "figures/r_output/combined_figs/figS4.tiff",
format = "tiff", quality = 100)
# remove files
rm(figS4, figS4a, figS4b)
# clear up the env
gc()
